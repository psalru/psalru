---
sidebar_label: Datalens
description: –ü—Ä–∏–º–µ—Ä—ã –ø—É–±–ª–∏—á–Ω—ã—Ö –¥–∞—à–±–æ—Ä–¥–æ–≤ –Ω–∞ BI Datalens
---

# –ü—Ä–∏–º–µ—Ä—ã –¥–∞—à–±–æ—Ä–¥–æ–≤ –Ω–∞ Datalens

–ù–∞ –¥–∞–Ω–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –æ–ø–∏—Å–∞–Ω—ã –ø—Ä–∏–º–µ—Ä—ã –¥–∞—à–±–æ—Ä–¥–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ —Ä–∞–º–∫–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º [Datalens](https://cloud.yandex.ru/services/datalens) (–æ–±–ª–∞—á–Ω–∞—è –≤–µ—Ä—Å–∏—è). –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ç–æ, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –ø–æ–ø–æ–ª–Ω—è—é—Ç—Å—è (–≤ —Ç–µ–∫—Å—Ç–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç —Å—Å—ã–ª–∫–∏ –Ω–∞ –∫–æ–¥) –∏ —è —Å—Ç–∞—Ä–∞—é—Å—å —Å–ª–µ–¥–∏—Ç—å –∑–∞ –∏—Ö –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å—é, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Å–∫–æ—Ä–µ–π **–ø–æ–ø—ã—Ç–∫–∞ –ø–æ–∫–∞–∑–∞—Ç—å –æ–¥–∏–Ω –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ ¬´–∫–∞–∫ –º–æ–∂–Ω–æ¬ª** –∏ –ø–æ–±—É–¥–∏—Ç—å/–≤–¥–æ—Ö–Ω–æ–≤–∏—Ç—å –í–∞—Å –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–¥–µ–ª–∞—Ç—å —á—Ç–æ-—Ç–æ –ø–æ—Ö–æ–∂–µ–µ —É —Å–µ–±—è –≤ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–µ.

:::caution –í—ã–±–æ—Ä–∫–∞ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–≤

–î–ª—è –≤—Å–µ—Ö –¥–∞—à–±–æ—Ä–¥–æ–≤, –∫–æ–≥–¥–∞ —Ä–µ—á—å –∏–¥—ë—Ç –æ–± —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞—Ö, –≤ –≤—ã–±–æ—Ä–∫—É –≤–∫–ª—é—á–∞—é—Ç—Å—è —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç—ã, —É—á–∞—Å—Ç–Ω–∏–∫–∏ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º [¬´–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2030¬ª](https://priority2030.ru/) –∏ [¬´–ü–µ—Ä–µ–¥–æ–≤—ã–µ –∏–Ω–∂–µ–Ω–µ—Ä–Ω—ã–µ —à–∫–æ–ª—ã¬ª](https://engineers2030.ru/) (–µ—Å–ª–∏ —è —É—Å–ø–µ–ª/–Ω–µ –ø–æ–ª–µ–Ω–∏–ª—Å—è –≤—Å—ë –∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å ü•¥).

:::

–î–ª—è —Ç–µ—Ö, –∫–æ–º—É –Ω—É–∂–Ω—ã –æ–±—É—á–∞—é—â–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã, –∞ **–Ω–µ –ø—Ä–∏–º–µ—Ä—ã —á–µ–≥–æ-—Ç–æ** –≥–æ—Ç–æ–≤–æ–≥–æ:

1. –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π [–∫—É—Ä—Å –ø–æ Datalens](https://cloud.yandex.ru/training/datalens)
1. –ï–∂–µ–≥–æ–¥–Ω–æ –ø—Ä–æ–≤–æ–¥–∏—Ç—Å—è [DataLens Festival](https://cloud.yandex.ru/datalens-festival) (—Å–º. –∞—Ä—Ö–∏–≤—ã –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤)
1. –í –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π [–≥—Ä—É–ø–ø–µ Datalens –≤ –¢–µ–ª–µ–≥—Ä–∞–º](https://t.me/YandexDataLens) –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å —Å–æ–æ–±—â–µ—Å—Ç–≤—É

## –í–∞–∫–∞–Ω—Å–∏–∏ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–≤

–í üìä [–¥–∞—à–±–æ—Ä–¥–µ]((https://datalens.yandex/qv1g5xwqyzysg)) –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ [–ø–æ—Ä—Ç–∞–ª–∞ HH](https://hh.ru/), –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è –µ—Å–ª–∏ –Ω–µ —Å–∞–º—ã–º –ø–æ–ø—É–ª—è—Ä–Ω—ã–º —Ä–µ—Å—É—Ä—Å–æ–º –ø–æ –ø–æ–∏—Å–∫—É —Ä–∞–±–æ—Ç—ã –≤ üá∑üá∫ –†–æ—Å—Å–∏–∏, —Ç–æ —Ç–æ—á–Ω–æ –≤—Ö–æ–¥–∏—Ç –≤ **–æ—á–µ–Ω—å –∫–æ—Ä–æ—Ç–∫–∏–π —Å–ø–∏—Å–æ–∫ –ª–∏–¥–µ—Ä–æ–≤**. –î–∞–Ω–Ω—ã–µ **—Å –º–∞—Ä—Ç–∞ 2023 –≥–æ–¥–∞** —Å–æ–±–∏—Ä–∞—é—Ç—Å—è —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é —Å –ø–æ–º–æ—â—å—é Apache Airflow (–ø–æ–¥—Ä–æ–±–Ω–µ–µ –æ–± —ç—Ç–æ–º DAG-–µ —á–∏—Ç–∞–π—Ç–µ –ø–æ [—Å—Å—ã–ª–∫–µ](/docs/tools/airflow#dag-—Å–æ–±–∏—Ä–∞—é—â–∏–π-–≤–∞–∫–∞–Ω—Å–∏–∏-—É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–≤)).

–í –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –¥–∞—à–±–æ—Ä–¥ —Ä–∞–∑–±–∏—Ç –Ω–∞ 3 –≤–∫–ª–∞–¥–∫–∏:

1. üìä [–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ –≤–∞–∫–∞–Ω—Å–∏—è–º](https://datalens.yandex/qv1g5xwqyzysg?tab=mP) ‚Äî –≤–∫–ª–∞–¥–∫–∞ —Å **–æ–±—â–µ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π** –ø–æ –≤—Å–µ–º—É –º–∞—Å—Å–∏–≤—É —Å–æ–±–∏—Ä–∞–µ–º—ã—Ö –≤–∞–∫–∞–Ω—Å–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–≤;
1. üîç [–ü–æ–∏—Å–∫ –ø–æ –≤–∞–∫–∞–Ω—Å–∏—è–º](https://datalens.yandex.ru/qv1g5xwqyzysg-vakansii-universitetov-rf?tab=R2) ‚Äî –¥–∞–Ω–Ω–∞—è –≤–∫–ª–∞–¥–∫–∞ —Å–∫–æ—Ä–µ–π **–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞ –Ω–∞ —Å–æ–∏—Å–∫–∞—Ç–µ–ª–µ–π**, –≤ –∫–æ—Ç–æ—Ä–æ–π –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —É–¥–æ–±–Ω–æ –º–æ–∂–Ω–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –≤–∞–∫–∞–Ω—Å–∏–∏ –ø–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º –∏ –ø–æ–≤—ã–±–∏—Ä–∞—Ç—å –¥–ª—è —Å–µ–±—è —á—Ç–æ-—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ;
1. üìë [–û—Ç—á—ë—Ç—ã –ø–æ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞–º](https://datalens.yandex.ru/qv1g5xwqyzysg-vakansii-universitetov-rf?tab=dw) ‚Äî –¥–∞–Ω–Ω–∞—è –≤–∫–ª–∞–¥–∫–∞ —Å–æ–∑–¥–∞–≤–∞–ª–∞—Å—å –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–≤—è–∑–∫—É –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π Datalens –∏ [–æ–±–ª–∞—á–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π](https://cloud.yandex.ru/services/functions) –¥–ª—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –¥–µ—à—ë–≤–æ–≥–æ —Å–ø–æ—Å–æ–±–∞ **–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á—ë—Ç–æ–≤**.

### –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö –ø–æ –≤–∞–∫–∞–Ω—Å–∏—è–º

–¢–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç —Å–±–æ—Ä–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤ Datalens (–æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ –ø–æ–ª—é `vac_id` –∏ `u_id`):

![–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ –≤–∞–∫–∞–Ω—Å–∏—è–º —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–≤](vacancies.png "–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ –≤–∞–∫–∞–Ω—Å–∏—è–º —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–≤")

–î–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —Ç–∞–±–ª–∏—Ü—É `vacancies`, —É–Ω–∏–∫–∞–ª–∏–∑–∏—Ä—É—è –∑–∞–ø–∏—Å–∏ –∏ –æ—Ç–±–∏—Ä–∞—è —Å–∞–º—ã–µ –ø–æ—Å–ª–µ–¥–Ω–∏–µ:

```sql showLineNumbers title="–¢–∞–±–ª–∏—Ü–∞ —Å –≤–∞–∫–∞–Ω—Å–∏—è–º–∏ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–≤"
select distinct on (hh_id)
    hv.deleted_at            as vac_deleted_at,
    hv.id                    as vac_id,
    hv.hh_initial_created_at as vac_create_at,
    hv.title                 as vac_title,
    hv.salary_from           as vac_salary_from,
    hv.salary_to             as vac_salary_to,
    hv.salary_gross          as vac_salary_gross,
    hv.experience            as vac_experience,
    hv.schedule              as vac_schedule,
    hv.employment            as vac_employment,
    hv.url                   as vac_url,
    gfr.title                as vac_region,
    uu.id                    as u_id,
    uu.geo_point             as u_geo_point,
    uu.title_short           as u_title_short,
    uu.title_display         as u_title_display,
    uu.domain                as u_domain
from hh_vacancy hv
left join hh_hh_university hhu on hhu.id = hv.hh_university_id
left join university_university uu on uu.id = hhu.university_id
left join geo_federal_region gfr on gfr.id = hv.federal_region_id
where uu.deleted_at is null and hhu.deleted_at is null
order by hh_id, hv.created_at desc
```

–≠—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —Ç–∞–±–ª–∏—Ü—É `professional_roles`:

```sql showLineNumbers title="–¢–∞–±–ª–∏—Ü–∞ —Å –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–º–∏ —Ä–æ–ª—è–º–∏ –≤–∞–∫–∞–Ω—Å–∏–π"
select
    hpr.vacancy_id as vac_id,
    hpr.title as professional_role_title
from hh_professional_role hpr
where
    hpr.vacancy_id in (select distinct on (hv.hh_id) hv.id from hh_vacancy hv order by hv.hh_id, hv.created_at desc) and
    hpr.deleted_at is null
```

–≠—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —Ç–∞–±–ª–∏—Ü—É `skills`:

```sql showLineNumbers title="–¢–∞–±–ª–∏—Ü–∞ —Å —Ç—Ä–µ–±—É–µ–º—ã–º–∏ –Ω–∞–≤—ã–∫–∞–º–∏"
select
    hs.vacancy_id as vac_id,
    hs.title as skill_title
from hh_skill hs
where
    hs.vacancy_id in (select distinct on (hv.hh_id) hv.id from hh_vacancy hv order by hv.hh_id, hv.created_at desc) and
    hs.deleted_at is null
```

–≠—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —Ç–∞–±–ª–∏—Ü—É `universities_statuses`:

```sql showLineNumbers title="–¢–∞–±–ª–∏—Ü–∞ —Å —Ç–µ–∫—É—â–∏–º–∏ —Å—Ç–∞—Ç—É—Å–∞–º–∏ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–≤"
select
    uus.university_id as u_id,
    us.title as status_title
from university_university_status uus
join university_status us on us.id = uus.status_id
```

–ù–∞ –≤—ã—Ö–æ–¥–µ [–ø–æ–ª—É—á–∏–ª—Å—è](https://datalens.yandex/qv1g5xwqyzysg) –¥–æ–≤–æ–ª—å–Ω–æ **–ø—Ä–∞–∫—Ç–∏—á–Ω—ã–π –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç** ü§ó, –∫–æ—Ç–æ—Ä—ã–π, –µ—Å–ª–∏ —Ä–∞—Å—à–∏—Ä–∏—Ç—å –¥–æ –≤—Å–µ—Ö —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–≤, –≤–æ–∑–º–æ–∂–Ω–æ –º–æ–≥ –±—ã –∑–∞–º–µ–Ω–∏—Ç—å ¬´–æ—á–µ–Ω—å —É–¥–æ–±–Ω—ã–π¬ª —Ä–µ—Å—É—Ä—Å [—É—á–µ–Ω—ã–µ-–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–∏.—Ä—Ñ](https://xn----8sbfhdabdwf1afqu5baxe0f2d.xn--p1ai/), —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫–æ—Ç–æ—Ä–æ–≥–æ, –Ω–∞ –º–æ–π –≤–∑–≥–ª—è–¥, **—Å—Ç—Ä–µ–º–∏—Ç—Å—è –∫ –Ω—É–ª—é** (–ª–∏—á–Ω–æ –º–Ω–µ –¥–∞–∂–µ –∂–∞–ª–∫–æ —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–∞, –∫–æ—Ç–æ—Ä–æ–µ —Ç—Ä–∞—Ç–∏—Ç—Å—è –Ω–∞ –µ–≥–æ —Ä–∞–±–æ—Ç—É üòî).

## –ö–æ–Ω–≤–µ—Ä—Å–∏—è –ù–ò–û–ö–¢–† –≤ –†–ò–î—ã –∏ –¥–∏—Å—Å–µ—Ä—Ç–∞—Ü–∏–∏

–ò–¥–µ—è –¥–∞–Ω–Ω–æ–≥–æ üìä [–¥–∞—à–±–æ—Ä–¥–∞](https://datalens.yandex/l4s0fnxnl1oib) —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ–±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫–∞–∫ –≤—ã–ø–æ–ª–Ω—è–µ–º—ã–µ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–º **–ù–ò–û–ö–¢–† –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—Ç** –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∏ –ø–µ—Ä–µ—Å–µ–∫–∞—é—Ç—Å—è –ø–æ —Ç–µ–º–∞—Ç–∏–∫–∞–º (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä OECD) **c –†–ò–î-–∞–º–∏ –∏ –¥–∏—Å—Å–µ—Ä—Ç–∞—Ü–∏—è–º–∏** —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–≤. –ó–∞–±–æ—Ä–æ–º –¥–∞–Ω–Ω—ã—Ö –∏–∑  [–ï–ì–ò–°–£ –ù–ò–û–ö–¢–†](https://rosrid.ru/) –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è DAG, –ø—Ä–æ –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –ø–æ—á–∏—Ç–∞—Ç—å –ø–æ [—Å—Å—ã–ª–∫–µ](/docs/tools/airflow#dag-—Å–æ–±–∏—Ä–∞—é—â–∏–π-–Ω–∏–æ–∫—Ç—Ä-—Ä–∏–¥-–∏-–¥–∏—Å—Å–µ—Ä—Ç–∞—Ü–∏–∏).

### –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –±–∞–∑–µ –ï–ì–ò–°–£ –ù–ò–û–ö–¢–†

–û–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –≤ Datalens (–æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ –ø–æ–ª—é `active_id` –∏ `university_id`):

![–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ –ù–ò–û–ö–¢–†, –†–ò–î –∏ –¥–∏—Å—Å–µ—Ä—Ç–∞—Ü–∏—è–º](rosrid.png "–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ –ù–ò–û–ö–¢–†, –†–ò–î –∏ –¥–∏—Å—Å–µ—Ä—Ç–∞—Ü–∏—è–º")

–í–æ—Ç —Ç–∞–∫–æ–π –∑–∞–ø—Ä–æ—Å —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —Ç–∞–±–ª–∏—Ü—É `actives`:

```sql showLineNumbers title="–¢–∞–±–ª–∏—Ü–∞ —Å –∞–∫—Ç–∏–≤–∞–º–∏ (–ù–ò–û–ö–¢–†, –†–ò–î –∏ –¥–∏—Å—Å–µ—Ä—Ç–∞—Ü–∏–∏) —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–≤"
select
    ra.id as active_id,
    ra.object_id as object_id,
    date_trunc('month', ra.date)::date as date,
    rat.title_short as type,
    ra.title,
    uu.id as university_id,
    uu.title_display as university,
    uu.title as university_full,
    gfd.title as federal_district,
    gfr.title as region,
    ra.url,
    ra.s3_bucket,
    ra.s3_key
from rosrid_active ra
join rosrid_active_type rat on rat.id = ra.type_id
join rosrid_rosrid_university rru on rru.id = ra.rosrid_university_id
join university_university uu on uu.id = rru.university_id
join geo_city gc on gc.id = uu.city_id
join geo_federal_district gfd on gfd.id = gc.federal_district_id
join geo_federal_region gfr on gfr.id = gc.federal_region_id
where
    -- –ê–∫—Ç–∏–≤ –Ω–µ —É–¥–∞–ª—ë–Ω
    ra.deleted_at is null and
    -- –£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –Ω–µ —É–¥–∞–ª—ë–Ω
    uu.deleted_at is null and
    -- –ê–∫—Ç–∏–≤ —Ä–µ–∞–ª—å–Ω–æ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞
    ra.is_executor
order by ra.date
```

–ó–∞–ø—Ä–æ—Å —Ñ–æ—Ä–º–∏—Ä—É—é—â–∏–π —Ç–∞–±–ª–∏—Ü—É `active_oecd`:

```sql showLineNumbers title="–¢–∞–±–ª–∏—Ü–∞ —Å OECD –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞–º–∏ –∞–∫—Ç–∏–≤–æ–≤"
select
    rao.active_id,
    concat('0', dog.code, ' - ', dog.title) oecd
from rosrid_active_oecd rao
join rosrid_active ra on ra.id = rao.active_id
join dict_oecd d on d.id = rao.oecd_id
join dict_oecd_group dog on dog.id = d.oecd_group_id
where ra.deleted_at is null
group by active_id, oecd
```

–ó–∞–ø—Ä–æ—Å —Ñ–æ—Ä–º–∏—Ä—É—é—â–∏–π —Ç–∞–±–ª–∏—Ü—É `university_status`:

```sql showLineNumbers title="–¢–∞–±–ª–∏—Ü–∞ —Å —Ç–µ–∫—É—â–∏–º–∏ —Å—Ç–∞—Ç—É—Å–∞–º–∏ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–≤"
select
    uus.university_id,
    us.title as university_status
from university_university_status uus
join university_status us on us.id = uus.status_id
join university_university uu on uu.id = uus.university_id
where uu.deleted_at is null
```

–°–∞–º–∞ –∏–¥–µ—è [–¥–∞—à–±–æ—Ä–¥–∞](https://datalens.yandex/l4s0fnxnl1oib) –º–Ω–µ –¥–æ —Å–∏—Ö –ø–æ—Ä –Ω—Ä–∞–≤–∏—Ç—Å—è, –Ω–æ –æ–Ω–∞ **–Ω–µ –¥–æ –∫–æ–Ω—Ü–∞ –æ—Ç—Ä–∞–∂–∞–µ—Ç –æ–±—ä–µ–∫—Ç–∏–≤–Ω—É—é –∫–∞—Ä—Ç–∏–Ω—É**, —Ç.¬†–∫. [–ï–ì–ò–°–£ –ù–ò–û–ö–¢–†](https://rosrid.ru/), –Ω–∞ —Å–∫–æ–ª—å–∫–æ —è –ø–æ–Ω–∏–º–∞—é, —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–ª–µ–∫–æ –Ω–µ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∫–∞—Å–∞—é—â–∏–µ—Å—è –ù–ò–û–ö–¢–† —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–≤, –∞ –ª–∏—à—å —Ç—É —á–∞—Å—Ç—å, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ —Å–≤—è–∑–∞–Ω–∞ —Å –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–º —Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ–º. –° –∫–æ–ª–ª–µ–≥–∞–º–∏ –∏–∑ [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏](https://integration.institute/) –º—ã —Å—á–∏—Ç–∞–µ–º, —á—Ç–æ –±–µ–∑ –ª–∏—à–Ω–∏—Ö –æ–≥–æ–≤–æ—Ä–æ–∫ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ **–¥–∞–Ω–Ω—ã–µ –ø—Ä–æ –¥–∏—Å—Å–µ—Ä—Ç–∞—Ü–∏–∏** –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π üëç

## –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–π –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ

–£ Google —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Å–µ—Ä–≤–∏—Å [Google Alerts](https://www.google.com/alerts), –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º (–≤ –º–æ—ë–º —Å–ª—É—á–∞–µ —ç—Ç–æ _¬´–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2030¬ª_, _¬´–ø—Ä–æ–≥—Ä–∞–º–º–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–≥–æ –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–æ–≥–æ –ª–∏–¥–µ—Ä—Å—Ç–≤–∞¬ª_, _¬´priority 2030¬ª_ –∏ _¬´–ø–µ—Ä–µ–¥–æ–≤—ã–µ –∏–Ω–∂–µ–Ω–µ—Ä–Ω—ã–µ —à–∫–æ–ª—ã¬ª_) –Ω–∞ –Ω–æ–≤—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –ø–æ—è–≤–ª—è—é—â–∏–µ—Å—è –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ. –≠–∫—Å–ø–ª—É–∞—Ç–∏—Ä—É—è —ç—Ç—É –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–æ–¥–∏–ª–∞—Å—å –∏–¥–µ—è –¥–∞–Ω–Ω–æ–≥–æ üìä [–¥–∞—à–±–æ—Ä–¥–∞](https://datalens.yandex/yogp2fsiiqh4o), –∫–æ—Ç–æ—Ä–∞—è —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ –±—ã –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –Ω–∞ –±–∞–∑–µ —ç—Ç–æ–≥–æ **–±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞** —á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ ¬´–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±—Ä–µ–Ω–¥–∞ –¥–ª—è –±–µ–¥–Ω—ã—Ö¬ª üëå –ü—Ä–æ DAG —Å–æ–±–∏—Ä–∞—é—â–∏–π –¥–∞–Ω–Ω—ã–µ –º–æ–∂–Ω–æ –ø–æ—á–∏—Ç–∞—Ç—å –ø–æ [—Å—Å—ã–ª–∫–µ](/docs/tools/airflow#dag-—Ä–∞–±–æ—Ç–∞—é—â–∏–π-—Å-google-alerts).

### –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏

–î–ª—è –¥–∞–Ω–Ω–æ–≥–æ –¥–∞—à–±–æ—Ä–¥–∞ –º—ã –æ–±—Ö–æ–¥–∏–º—Å—è –≤—Å–µ–≥–æ –æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ–π `newsfeed`:

```sql showLineNumbers title="–¢–∞–±–ª–∏—Ü–∞ —Å –ø—É–±–ª–∏–∫–∞—Ü–∏–º–∏—è"
select 
    id,
    created_at,
    updated_at,
    deleted_at,
    hash,
    topic,
    keyword,
    date,
    domain,
    url,
    title,
    content,
    s3_bucket,
    s3_key,
    row_number() over (partition by url) as number 
from google_alerts_newsfeed
where deleted_at is null order by id
```

–° —É—á—ë—Ç–æ–º —Ç–æ–≥–æ, —á—Ç–æ Google Alert –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π, **–≤—Å—ë –æ—Ç–ª–∏—á–Ω–æ** üëç –ù–æ –µ—Å–ª–∏ —Ö–æ—á–µ—Ç—Å—è –±–æ–ª—å—à–µ–π —Ç–æ—á–Ω–æ—Å—Ç–∏, —Ç—É—Ç –≤–æ–∑–Ω–∏–∫–∞—é—Ç –ø—Ä–æ–±–ª–µ–º—ã:

1. –°–µ—Ä–≤–∏—Å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —á–∞—Å—Ç–Ω–æ –ø—Ä–∏—Å—ã–ª–∞–µ—Ç –ª–æ–∂–Ω–æ–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –≤—ã—á–∏—â–∞—Ç—å —Ä—É–∫–∞–º–∏.
1. –°–µ—Ä–≤–∏—Å –∏—â–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–∞–π—Ç–∞—Ö, —É–ø—É—Å–∫–∞—è –±–æ–ª—å—à—É—é —á–∞—Å—Ç—å –ø—É–±–ª–∏–∫–∞—Ü–∏–π –≤ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç—è—Ö –∏ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞—Ö.

–ï—Å–ª–∏ —Ö–æ—á–µ—Ç—Å—è **–≤—Å—ë ¬´–ø–æ –≤–∑—Ä–æ—Å–ª–æ–º—É¬ª**, —Å–º. –≤ —Å—Ç–æ—Ä–æ–Ω—É —Ç–∞–∫–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –∫–∞–∫ [brand analytics](https://brandanalytics.ru/).
